<div id="analytics">
  <div class="col-md-9 col-md-push-3">
    <div class="row">

      <div class="col-md-10 col-sm-12 col-md-push-2">
        <div id="alert" class="alert alert-danger alert-dismissible"
             ng-class="{invisible: !analytics.alert.show}">
          <button type="button" class="close"
                  ng-click="analytics.alert.show = false"
                  aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          {{alert.message}}
        </div>
        <highchart id="sensor-chart" config="analytics.chartConfig"></highchart>
      </div>

      <div id="sensor-ctrl" class="col-md-2 col-md-pull-10">
        <div id="time-frame" class="btn-group" dropdown>
          <button class="btn btn-black dropdown-toggle"
                  dropdown-toggle
                  data-label-placement
                  style="white-space: normal">
            <span ng-if="analytics.timeFrame.params.end">
              <span style="white-space: nowrap">
                {{analytics.timeFrame.params.begin.split('T')[0]}}
              </span>
              to
              <span style="white-space: nowrap">
                {{analytics.timeFrame.params.end.split('T')[0]}}
              </span>
            </span>
            <span ng-if="!analytics.timeFrame.params.end">
              {{analytics.timeFrame.text}}
            </span>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu pull-right typeMenu" role="menu">
            <li class="btn" disabled>
              Choose time frame
            </li>
            <li ng-repeat="timeFrame in analytics.timeFrames">
              <a ng-disabled="timeFrame == analytics.timeFrame"
                 ng-click="analytics.selectTime(timeFrame)">
                <img class="icons" ng-src="{{timeFrame.icon}}"> {{timeFrame.text}}
              </a>
            </li>
          </ul>
        </div>

        <div id="drop-area"
             class="hidden-xs hidden-sm"
             title="You can view multiple sensor values at a time by dragging sensors to the drop area.">
          <div id="{{analytics.sensor.id}}" class="sensor-legend" ng-repeat="sensor in analytics.sensors" draggable="true">
            <img ng-src="images/{{sensor.name}}.svg">
            <div>{{sensor.room}}: {{sensor.text}}</div>
          </div>
          <h3 ng-show="!analytics.sensors.length">Drop a sensor here</h3>
        </div>

        <div id="clear-btn">
          <button class="btn btn-default" ng-click="analytics.clearSensors()">Clear sensors</button>
        </div>
      </div>

    </div>
  </div>

  <div class="col-md-3 col-md-pull-9 sensor-tree">
    <input id="sensor-tree-search" class="form-control"
      ng-model="searchStr"
      type="text"
      placeholder="Search">
    <sensor-tree id="sensor-tree"
      root-url="'http://otaniemi3d.cs.hut.fi/omi/node/Objects/K1/'"
      select-sensor="analytics.addSensor"
      drag-sensor="analytics.addSensor"
      checkbox="analytics.mobileDevice"
      search="analytics.searchStr"
      error="analytics.alert">
    </sensor-tree>
  </div>
</div>
